package ui;

import manager.EquipmentManager;
import manager.RentalManager;
import model.Admin;
import model.Student;
import model.User;

import javax.swing.*;
import java.awt.*;

/*
 * LoginFrame
 * Demonstrates:
 * - Polymorphism (User reference, different object types)
 * - Simple role-based navigation
 */
public class LoginFrame extends JFrame {

    private static final long serialVersionUID = 1L;

    private EquipmentManager equipmentManager;
    private RentalManager rentalManager;

    public LoginFrame(EquipmentManager equipmentManager, RentalManager rentalManager) {
        this.equipmentManager = equipmentManager;
        this.rentalManager = rentalManager;

        setTitle("Login");
        setSize(400, 250);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JLabel title = new JLabel("University Sports Gear Rental Manager", JLabel.CENTER);
        title.setFont(new Font("Arial", Font.BOLD, 16));

        JLabel lblName = new JLabel("Name:");
        JTextField txtName = new JTextField(15);

        JLabel lblRole = new JLabel("Role:");
        String[] roles = {"Admin", "Student"};
        JComboBox<String> cbRole = new JComboBox<>(roles);

        JButton btnLogin = new JButton("Login");

        JPanel centerPanel = new JPanel();
        centerPanel.add(lblName);
        centerPanel.add(txtName);
        centerPanel.add(lblRole);
        centerPanel.add(cbRole);

        add(title, BorderLayout.NORTH);
        add(centerPanel, BorderLayout.CENTER);
        add(btnLogin, BorderLayout.SOUTH);

        // ---------- LOGIN ACTION ----------
        btnLogin.addActionListener(e -> {
            String name = txtName.getText();
            String role = cbRole.getSelectedItem().toString();

            if (name.isEmpty()) {
                JOptionPane.showMessageDialog(this,
                        "Please enter your name",
                        "Input Error",
                        JOptionPane.ERROR_MESSAGE);
                return;
            }

            // üîÅ POLYMORPHISM: User reference, different object types
            User user;
            if (role.equals("Admin")) {
                user = new Admin("A001", name);
            } else {
                user = new Student("S001", name);
            }

            new MainFrame(user, equipmentManager, rentalManager).setVisible(true);
            dispose();
        });
    }
}
